import{c as n,b as w,a as e,B as k,C as V,t as u,F as c,d as b,j as v,g as t,w as E,m as d,p as f,q as g,n as m,D as P,E as U,G as C,o as l,v as T}from"./index-pdZddJkE.js";import{F as y,H as h}from"./FooterComponent-CFeuobls.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";const D={class:"wrap"},I={class:"content"},$={class:"container"},N={class:"row"},q={class:"sidebar col-md-3 col-lg-2"},F={class:"sidebar-content"},M=["src"],S={class:"name"},O=["onClick"],j={class:"col-md-9 col-lg-10"},H={class:"form-group"},z=["disabled"],G={class:"form-group"},L=["for"],W=["id","onUpdate:modelValue"],A=["value","disabled"],J={class:"btn_saveBtn"},K={key:1,id:"password"},Q={class:"password-container"},R={class:"password-inputs"},X={class:"form-group"},Y={class:"form-group"},Z={class:"password-input-group"},_=["type","disabled"],x={class:"form-group"},ee={class:"password-input-group"},se=["type","disabled"],oe={class:"btn_saveBtn"},ie={name:"userprofilePage",components:{HeaderComponent:h,FooterComponent:y},data(){return{isEditable:{name:!1,new:!1,confirm:!1},currentTab:"會員資訊",tabs:["會員資訊","會員等級","個人偏好設定","個人訂單查看"],icons:{會員資訊:"bi bi-person-vcard",會員等級:"bi bi-trophy",個人偏好設定:"bi bi-gear",個人訂單查看:"bi bi-cart-check",密碼管理:"bi bi-shield-lock"},user:{name:"",email:"",preference1:"",preference2:"",preference3:""},preferences:[{label:"個人偏好",model:"preference1"},{label:"次要偏好",model:"preference2"},{label:"第三偏好",model:"preference3"}],options:["探索冒險","放鬆療癒","文化體驗","美食探索","都市感官","自然療癒","親子家庭","拍照打卡","懶人輕鬆","特殊主題"],password:{current:"",new:{value:"",confirm:""}},passwordVisible:{new:!1,confirm:!1}}},mounted(){this.fetchUserInfo()},methods:{togglePassword(r){this.passwordVisible[r]=!this.passwordVisible[r]},toggleEdit(r){this.isEditable[r]=!this.isEditable[r]},isOptionDisabled(r,o){return[{key:"preference1",val:this.user.preference1},{key:"preference2",val:this.user.preference2},{key:"preference3",val:this.user.preference3}].some(i=>i.key!==o&&i.val===r)},async fetchUserInfo(){const r=await C();this.user={name:r.data.user.name,email:r.data.user.email,preference1:r.data.user.preferences[0],preference2:r.data.user.preferences[1],preference3:r.data.user.preferences[2]}},async updateUserInfo(){const r={name:this.user.name,preference:[this.user.preference1,this.user.preference2,this.user.preference3]};await U(r),this.isEditable.name=!1},async updateUserPassword(){console.log(this.password.current),await P(this.password.current,this.password.new.value,this.password.new.confirm,()=>{this.password.current="",this.password.new.value="",this.password.new.confirm="",this.isEditable.password=!1}),this.isEditable.new=!1,this.isEditable.confirm=!1}}},re=Object.assign(ie,{setup(r){return(o,s)=>(l(),n("div",D,[w(h),e("div",I,[e("div",$,[e("div",N,[e("div",q,[e("div",F,[e("img",{class:"headimg",src:k(V).userPicture,alt:"頭像"},null,8,M),e("div",S,u(o.user.name),1),(l(!0),n(c,null,b(o.tabs,i=>(l(),n("div",{class:m(["sidebaritem",{active:o.currentTab===i}]),key:i,onClick:p=>o.currentTab=i},[e("i",{class:m(o.icons[i]+" me-2")},null,2),t(u(i),1)],10,O))),128))])]),e("div",j,[s[22]||(s[22]=e("div",{class:"title"},[e("i",{class:"bi bi-person-circle me-2"}),t("會員中心")],-1)),o.currentTab==="會員資訊"?(l(),n("form",{key:0,id:"userinfo",onSubmit:s[4]||(s[4]=E(()=>{},["prevent"]))},[s[17]||(s[17]=e("div",{class:"form-title"},[e("i",{class:"bi bi-person-vcard me-2"}),t("會員資訊")],-1)),e("div",H,[s[14]||(s[14]=e("label",{for:"name",class:"form-label"},"姓名",-1)),d(e("input",{type:"text",class:"form-control",id:"name","onUpdate:modelValue":s[0]||(s[0]=i=>o.user.name=i),disabled:!o.isEditable.name},null,8,z),[[f,o.user.name]]),e("span",{class:"edit-icon",onClick:s[1]||(s[1]=i=>o.toggleEdit("name"))},s[13]||(s[13]=[e("i",{class:"bi bi-pencil-square"},null,-1)]))]),e("div",G,[s[15]||(s[15]=e("label",{for:"email",class:"form-label"},"信箱",-1)),d(e("input",{type:"email",class:"form-control",id:"email","onUpdate:modelValue":s[2]||(s[2]=i=>o.user.email=i),disabled:"false"},null,512),[[f,o.user.email]])]),(l(!0),n(c,null,b(o.preferences,(i,p)=>(l(),n("div",{class:"form-group",key:p},[e("label",{for:"preference"+(p+1),class:"form-label"},u(i.label),9,L),d(e("select",{class:"form-select",id:"preference"+(p+1),"onUpdate:modelValue":a=>o.user[i.model]=a},[(l(!0),n(c,null,b(o.options,a=>(l(),n("option",{key:a,value:a,disabled:o.isOptionDisabled(a,i.model)},u(a),9,A))),128))],8,W),[[T,o.user[i.model]]])]))),128)),e("div",J,[e("button",{type:"button",class:"btn btn-primary save-button",onClick:s[3]||(s[3]=(...i)=>o.updateUserInfo&&o.updateUserInfo(...i))},s[16]||(s[16]=[e("i",{class:"bi bi-check-circle me-2"},null,-1),t("儲存設定 ")]))])],32)):v("",!0),o.currentTab==="會員資訊"?(l(),n("form",K,[s[21]||(s[21]=e("div",{class:"form-title"},[e("i",{class:"bi bi-shield-lock me-2"}),t("密碼管理")],-1)),e("div",Q,[e("div",R,[e("div",X,[d(e("input",{type:"password","onUpdate:modelValue":s[5]||(s[5]=i=>o.password.current=i),class:"form-control password-input",id:"currentPassword",placeholder:"請輸入舊密碼"},null,512),[[f,o.password.current]])]),e("div",Y,[e("div",Z,[d(e("input",{type:o.passwordVisible.new?"text":"password",disabled:!o.isEditable.new,"onUpdate:modelValue":s[6]||(s[6]=i=>o.password.new.value=i),class:"form-control password-input",id:"newPassword",placeholder:"請輸入新密碼"},null,8,_),[[g,o.password.new.value]]),e("span",{class:"password-toggle",onClick:s[7]||(s[7]=i=>o.togglePassword("new"))},[e("i",{class:m(o.passwordVisible.new?"bi bi-eye-slash":"bi bi-eye")},null,2)]),e("span",{class:"edit-icon pw-edit-icon",onClick:s[8]||(s[8]=i=>o.toggleEdit("new"))},s[18]||(s[18]=[e("i",{class:"bi bi-pencil-square"},null,-1)]))])]),e("div",x,[e("div",ee,[d(e("input",{type:o.passwordVisible.confirm?"text":"password",disabled:!o.isEditable.confirm,"onUpdate:modelValue":s[9]||(s[9]=i=>o.password.new.confirm=i),class:"form-control password-input",id:"confirmNewPassword",placeholder:"再次輸入新密碼"},null,8,se),[[g,o.password.new.confirm]]),e("span",{class:"password-toggle",onClick:s[10]||(s[10]=i=>o.togglePassword("confirm"))},[e("i",{class:m(o.passwordVisible.confirm?"bi bi-eye-slash":"bi bi-eye")},null,2)]),e("span",{class:"edit-icon pw-edit-icon",onClick:s[11]||(s[11]=i=>o.toggleEdit("confirm"))},s[19]||(s[19]=[e("i",{class:"bi bi-pencil-square"},null,-1)]))])])])]),e("div",oe,[e("button",{type:"button",class:"btn btn-primary save-button",onClick:s[12]||(s[12]=(...i)=>o.updateUserPassword&&o.updateUserPassword(...i))},s[20]||(s[20]=[e("i",{class:"bi bi-check-circle me-2"},null,-1),t("更新密碼 ")]))])])):v("",!0)])])])]),w(y)]))}}),te=B(re,[["__scopeId","data-v-e21e358a"]]);export{te as default};
