<template>
  <div class="wrap">
    <!-- æ»‘å‹•å¾Œæ‰å‡ºç¾çš„ nav -->
    <div class="nav" :class="{ show: isSticky }">
      <NavComponent />
    </div>

    <div class="content">
      <div class="container">
        <!-- header å€å¡Š -->
        <div class="header_page" ref="header_page">
          <div class="header_main">
            <div class="header_country">
              <ul>
                <li v-for="(img, i) in currentImages" :key="selectedGroup + '-' + i">
                  <img :src="img" class="fade-in-img" />
                </li>
              </ul>

              <div class="illustration">
                <span><img src="@/assets/img/illustration/deco-img02.svg" alt="" /></span>
                <span><img src="@/assets/img/illustration/deco-img03.svg" alt="" /></span>
              </div>
            </div>

            <div class="header_img">
              <img src="@/assets/img/home_page.png" alt="" />
            </div>

            <div class="header_slogan">
              <div class="slogan_content">
                <p>è®“æ—…è¡Œæ›´è¼•é¬†</p>
                <p>è®“ä¸–ç•Œæ›´è¿‘!</p>
              </div>
              <div class="slogan_icon">
                <img
                  @click="selectGroup('Taiwan')"
                  :class="{ active: selectedGroup === 'Taiwan' }"
                  src="@/assets/img/icon/Taiwan.svg"
                  alt=""
                />
                <img
                  @click="selectGroup('World')"
                  :class="{ active: selectedGroup === 'World' }"
                  src="@/assets/img/icon/World.svg"
                  alt=""
                />
              </div>
            </div>
          </div>

          <div class="start_btn" @click="scrollToNext">
            <span>é–‹å§‹æ—…è¡Œ</span>
            <span><img src="@/assets/img/icon/arrow-down-long.svg" alt="" /></span>
          </div>
        </div>

        <div class="home_content">
          <div class="item_category">
            <h2>çŸšç›®åŠŸèƒ½</h2>

            <ul>
              <li>
                <h3>æ—…éŠæ¢ç´¢å’Œå³æ™‚é è¨‚</h3>
                <img src="@/assets/img/home_page/function-img03.svg" alt="" />
                <p>
                  æƒ³å»ä¸–ç•Œçš„æŸå€‹è§’è½ï¼Ÿæˆ‘å€‘æä¾›ç²¾é¸æ—…éŠè¡Œç¨‹ï¼Œä¾æ“šåœ°é»ã€åƒ¹æ ¼ã€èˆˆè¶£å¿«é€Ÿç¯©é¸ï¼Œç™¼æ˜ç•¶åœ°éš±è—ç©æ³•ï¼å³å°‡é–‹è³£çš„è¡Œç¨‹ä¸å†éŒ¯éï¼Œé‚„èƒ½åŠæ™‚æŒæ¡å„ªæƒ 
                </p>
              </li>
              <li>
                <h3>å€‹äººåŒ–æœƒå“¡é«”é©—</h3>
                <img src="@/assets/img/home_page/function-img02.svg" alt="" />
                <p>
                  è¨»å†Šæˆç‚ºæœƒå“¡ï¼Œè¿½è¹¤æ—…éŠç©åˆ†ã€VIPç­‰ç´šï¼Œç´¯ç©å°ˆå±¬å„ªæƒ ï¼æ”¶è—ä½ æ„Ÿèˆˆè¶£çš„æ—…ç¨‹ï¼Œè¨­å®šåƒ¹æ ¼è¿½è¹¤ï¼Œç•¶è¡Œç¨‹é™åƒ¹æˆ–æœ‰æ–°å„ªæƒ ï¼Œæˆ‘å€‘åŠæ™‚é€šçŸ¥ï¼Œè®“ä½ çš„æ—…è¡Œæ›´åˆ’ç®—ã€æ›´è‡ªç”±ï¼
                </p>
              </li>
              <li>
                <h3>å®‰å¿ƒæ”¯ä»˜</h3>
                <img src="@/assets/img/home_page/function-img01.svg" alt="" />
                <p>
                  é¸æ“‡ä½ çš„æ—…éŠé …ç›®ï¼Œé€éä¿¡ç”¨å¡ã€Apple Payã€Google
                  Payç­‰å®‰å…¨æ”¯ä»˜çµå¸³ï¼Œæ”¯æ´ä¿ƒéŠ·æŠ˜æ‰£èˆ‡é»æ•¸å…Œæ›ï¼
                </p>
              </li>
            </ul>
          </div>

          <div class="product">
            <div class="product_content">
              <div class="content_left">
                <div class="item_title">
                  <div class="product_title">
                    <h2>è³¼ç‰©å°ˆå€</h2>
                  </div>

                  <ul class="type_group">
                    <li><a class="active" href="#">æ—…è¡Œåœ˜</a></li>
                    <li><a href="#">èƒŒåŒ…å®¢</a></li>
                  </ul>
                </div>

                <ul class="item_group">
                  <li><a class="active" href="#">ç†±é–€å°ˆå€</a></li>
                  <li><a href="#">ä¿ƒéŠ·å°ˆå€</a></li>
                  <li><a href="#">å¤šäººæ”¶è—</a></li>
                </ul>

                <ul class="product_item">
                  <li
                    class="i_list"
                    v-for="item in productList"
                    :key="item.id"
                    @mouseover="hoveredMainImage = item.mainImage"
                  >
                    <div class="i_container">
                      <div class="product_left">
                        <ul>
                          <li v-for="(tag, tIdx) in item.tags" :key="tIdx">
                            <span>{{ tag }}</span>
                          </li>
                        </ul>
                        <h3>{{ item.title }}</h3>
                      </div>

                      <div class="product_right">
                        <div class="right_info">
                          <p>å‡ºç™¼æ—¥ : {{ item.departure || 'è‡ªç”±é¸æ“‡' }}</p>
                          <p>
                            <span>NT$</span><span>{{ item.price }}</span>
                          </p>
                        </div>

                        <span class="favorite"
                          ><img src="@/assets/img/icon/favorite-line.svg" alt=""
                        /></span>
                      </div>
                    </div>
                  </li>
                </ul>

                <ul class="product_page">
                  <li><img src="@/assets/img/icon/arrow-left.svg" alt="" /></li>
                  <li><a href="">1</a></li>
                  <li>/</li>
                  <li><a href="">3</a></li>
                  <li><img src="@/assets/img/icon/arrow-right.svg" alt="" /></li>
                </ul>
              </div>

              <div class="content_right">
                <div class="main_item">
                  <img :src="hoveredMainImage" alt="ç”¢å“ä¸»åœ–" />
                  <div class="illustration">
                    <span
                      ><img class="l_first" src="@/assets/img/illustration/deco-img01.svg" alt=""
                    /></span>
                    <span
                      ><img class="l_last" src="@/assets/img/illustration/deco-img03.svg" alt=""
                    /></span>
                  </div>
                </div>
              </div>
            </div>

            <div class="more">
              <span>æŸ¥çœ‹æ›´å¤š</span>
              <span><img src="@/assets/img/icon/arrow-right-long.svg" alt="" /></span>
            </div>
          </div>

          <div class="travel_tool">
            <div class="travel_title">
              <h2>æ—…éŠç¥å™¨</h2>
            </div>

            <div class="travel_content">
              <div class="travel_left">
                <!-- åœ–ç‰‡ -->
                <div class="main_item">
                  <img :src="tools[toolIndex].image" alt="" />
                </div>

                <!-- åŠŸèƒ½æŒ‰éˆ• -->
                <ul class="travel_function">
                  <li
                    v-for="(tool, index) in tools"
                    :key="index"
                    :class="['func', 'func' + (index + 1)]"
                  >
                    <a
                      href="#"
                      :class="{ active: index === toolIndex }"
                      @click.prevent="handleClick(index)"
                    >
                      {{ tool.name }}
                    </a>
                  </li>
                </ul>

                <!-- å°æ‡‰é»é» -->
                <ul class="travel_dot">
                  <li
                    v-for="(tool, index) in tools"
                    :key="'dot-' + index"
                    :class="['dot', 'dot' + (index + 1), { active: index === toolIndex }]"
                  ></li>
                </ul>

                <!-- å¼§å½¢è·¯å¾‘ -->
                <svg class="arc-path" width="650" height="695" viewBox="0 0 650 695">
                  <path
                    d="M190,-45 C470,220 430,475 250,670"
                    stroke="#D4D4D4"
                    stroke-width="3"
                    fill="none"
                  />
                </svg>
              </div>

              <div class="travel_right">
                <div class="main_content">
                  <div class="travel_new">
                    {{ tools[toolIndex].content }}
                  </div>
                  <div class="illustration">
                    <span
                      ><img class="l_first" src="@/assets/img/illustration/deco-img02.svg" alt=""
                    /></span>
                    <span
                      ><img class="l_last" src="@/assets/img/illustration/deco-img06.svg" alt=""
                    /></span>
                  </div>
                </div>
              </div>
            </div>

            <div class="more">
              <span>é–‹å§‹é«”é©—</span>
              <span><img src="@/assets/img/icon/arrow-right-long.svg" alt="" /></span>
            </div>
          </div>

          <div class="reviews">
            <h2>å¥½è©•å°ˆå€</h2>

            <div class="main_contents">
              <span class="left_btn" @click="prevSlide"
                ><img src="@/assets/img/icon/arrow-left.svg" alt=""
              /></span>
              <ul class="review_contents">
                <li v-for="review in visibleReviews" :key="review.name" class="review_card">
                  <img class="avatar" :src="review.avatar" alt="avatar" />

                  <div class="reviews_info">
                    <div class="i_title">
                      <div class="name">{{ review.name }}</div>
                      <div class="badge">
                        <img :src="review.badgeIcon" alt="badge" />
                        <span>{{ review.badgeText }}</span>
                      </div>
                    </div>

                    <div class="rating">
                      <img
                        v-for="n in 5"
                        :key="n"
                        :src="n <= review.stars ? starBold : starLine"
                        alt="star"
                      />
                    </div>
                  </div>

                  <div class="reviews_content">
                    <div class="hashtag">{{ review.hashtag }}</div>
                    <div class="content">
                      {{ truncatedText(review.content) }}
                    </div>
                  </div>
                </li>
              </ul>
              <span class="right_btn" @click="nextSlide"
                ><img src="@/assets/img/icon/arrow-right.svg" alt=""
              /></span>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Footer -->
    <FooterComponent />
  </div>
</template>

<script>
import NavComponent from '@/components/HeaderComponent.vue';
import FooterComponent from '@/components/FooterComponent.vue';

import taiwan_01 from '@/assets/img/home_page/viewpoint-img.svg';
import taiwan_02 from '@/assets/img/home_page/viewpoint-img-7.svg';
import taiwan_03 from '@/assets/img/home_page/viewpoint-img-1.svg';
import taiwan_04 from '@/assets/img/home_page/viewpoint-img-2.svg';
import world_01 from '@/assets/img/home_page/viewpoint-img-3.svg';
import world_02 from '@/assets/img/home_page/viewpoint-img-4.svg';
import world_03 from '@/assets/img/home_page/viewpoint-img-5.svg';
import world_04 from '@/assets/img/home_page/viewpoint-img-6.svg';

import productImg1 from '@/assets/img/product/Shopping-img.svg';
import productImg2 from '@/assets/img/product/Shopping-img-2.svg';
import productImg3 from '@/assets/img/product/Shopping-img-1.svg';

import tool_img01 from '@/assets/img/home_page/travel-img01.svg';
import tool_img02 from '@/assets/img/home_page/travel-img02.svg';
import tool_img03 from '@/assets/img/home_page/travel-img03.svg';
import tool_img04 from '@/assets/img/home_page/travel-img04.svg';
import tool_img05 from '@/assets/img/home_page/travel-img05.svg';

import avatar_img01 from '@/assets/img/avatar/avatar-img01.svg';
import avatar_img02 from '@/assets/img/avatar/avatar-img02.svg';
import avatar_img03 from '@/assets/img/avatar/avatar-img03.svg';
import avatar_img04 from '@/assets/img/avatar/avatar-img04.svg';

import badge_01 from '@/assets/img/badge/badge01.svg';
import badge_02 from '@/assets/img/badge/badge02.svg';
import badge_03 from '@/assets/img/badge/badge03.svg';
import badge_04 from '@/assets/img/badge/badge04.svg';
import badge_05 from '@/assets/img/badge/badge05.svg';

import starBold from '@/assets/img/icon/star-bold.svg';
import starLine from '@/assets/img/icon/star-line.svg';

export default {
  name: 'HomePage',
  components: {
    NavComponent,
    FooterComponent,
  },
  data() {
    return {
      isSticky: false,
      selectedGroup: 'Taiwan',
      imagesTaiwan: [taiwan_01, taiwan_02, taiwan_03, taiwan_04],
      imagesWorld: [world_01, world_02, world_03, world_04],
      currentImages: [],
      currentIndex: 0,
      interval: null,
      autoMode: true,
      productList: [
        {
          id: 1,
          title: 'é«˜é›„æ‰¿å„„é…’åº—',
          tags: ['æ¢ç´¢å†’éšª', 'æ–‡åŒ–é«”é©—', 'æ”¾é¬†ç™‚ç™’'],
          price: 7000,
          mainImage: productImg1, // å°æ‡‰å³å´å¤§åœ–
        },
        {
          id: 2,
          title: 'æ±äº¬é’å¹´å•†æ—…',
          tags: ['ç¾é£Ÿæ¢ç´¢', 'ç‰¹æ®Šä¸»é¡Œ', 'è¦ªå­ä¸»é¡Œ'],
          price: 5500,
          mainImage: productImg2,
        },
        {
          id: 3,
          title: 'æ´›æ‰ç£¯è±ªè¯é…’åº—',
          tags: ['æ‹ç…§æ‰“å¡', 'æ–‡åŒ–é«”é©—', 'éƒ½å¸‚æ„Ÿå®˜'],
          price: 12000,
          mainImage: productImg3,
        },
      ],
      hoveredMainImage: productImg1,
      selectedIndex: 0,
      toolIndex: 0, // è¼ªæ’­åœ–ç‰‡ index
      autoPlayTimer: null,
      resumeTimer: null,
      tools: [
        {
          id: 1,
          name: 'å¤©æ°£æŸ¥è©¢',
          content: 'éš¨æ™‚æŸ¥è©¢å³æ™‚å¤©æ°£ï¼Œæä¾›æº«åº¦ã€é™é›¨èˆ‡é¢¨é€Ÿè³‡è¨Šï¼Œè®“ä½ å®‰å¿ƒå‡ºé–€',
          image: tool_img01,
        },
        {
          id: 2,
          name: 'åŒ¯ç‡æŸ¥è©¢',
          content: 'å¿«é€ŸæŸ¥è©¢å„åœ‹åŒ¯ç‡ï¼Œå¹«åŠ©ä½ å³æ™‚æŒæ¡å¹£å€¼è®ŠåŒ–ï¼Œç²¾æ‰“ç´°ç®—æ—…è²»',
          image: tool_img02,
        },
        {
          id: 3,
          name: 'æ©Ÿç¥¨/ç§Ÿè»ŠæŸ¥è©¢',
          content: 'çµåˆå¤šå®¶å¹³å°è³‡è¨Šï¼Œæä¾›æœ€å„ªæƒ çš„æ©Ÿç¥¨èˆ‡ç§Ÿè»Šé¸æ“‡',
          image: tool_img03,
        },
        {
          id: 4,
          name: 'äº’å‹•åœ°åœ–',
          content: 'æ¢ç´¢æ™¯é»ã€è·¯ç·šèˆ‡äº¤é€šè³‡è¨Šï¼Œè®“ä½ ç©å¾—æ›´é †æ›´é–‹å¿ƒ',
          image: tool_img04,
        },
        {
          id: 5,
          name: 'æ–‡åŒ–ä»‹ç´¹',
          content: 'æ·±å…¥äº†è§£ç›®çš„åœ°æ–‡åŒ–èˆ‡é¢¨ä¿—ï¼Œè®“æ—…ç¨‹æ›´æœ‰æ·±åº¦èˆ‡æ¨‚è¶£',
          image: tool_img05,
        },
      ],
      reviews: [
        {
          name: 'ç‹å°æ˜',
          avatar: avatar_img01,
          badgeIcon: badge_03,
          badgeText: 'ä¸–ç•Œæ¢ç´¢è€…',
          stars: 5,
          hashtag: '#æ—…éŠç¥å™¨è®šè®šï¼',
          content:
            'æ—…éŠç¥å™¨å¤ªå¥½ç”¨äº†ï¼éå¸¸é©åˆæ—…éŠä¸­æ¯’è€…ä½¿ç”¨ï¼Œåˆ°äº†ä¸€å€‹åœ‹å®¶ï¼Œèƒ½å¤ é¦¬ä¸Šé¡¯ç¤ºå¤©æ°£é å ±ï¼Œéå¸¸æ–¹ä¾¿ï¼',
        },
        {
          name: 'åŠ‰å°èŠ¬',
          avatar: avatar_img02,
          badgeIcon: badge_01,
          badgeText: 'åˆå¿ƒæ—…äºº',
          stars: 4,
          hashtag: '#çœŸäººå®¢æœè§£æ±ºäº†æˆ‘çš„å•é¡Œï¼',
          content:
            'TripEasyäº”æ˜Ÿç´šæœå‹™ï¼Œ24å°æ™‚çš†æœ‰çœŸäººå®¢æœï¼Œä¸æœƒæ“ä½œï¼Œé¦¬ä¸Šå°±æœ‰äººå¯è©¢å•è§£æ±ºï¼è¦å®‰æ’è¡Œç¨‹è‚¯å®šè¦ä¾†ï½',
        },
        {
          name: 'é™³å°èŠ±',
          avatar: avatar_img03,
          badgeIcon: badge_02,
          badgeText: 'ç†±è¡€æ—…éŠå®¶',
          stars: 3,
          hashtag: '#è¡Œç¨‹æ¨è–¦',
          content:
            'é¦–é çš„æœ‹å‹å°ˆå€è¶…é©åˆæ—…éŠè¦åŠƒæ–°æ‰‹ï¼Œæ¨è–¦çš„è¡Œç¨‹çœŸçš„éå¸¸é©åˆæœ‹å‹æ—…éŠï¼Œåƒ¹æ ¼ä¹Ÿå¾ˆåˆç†ï¼',
        },
        {
          name: 'æ¸¸å°å½¥',
          avatar: avatar_img04,
          badgeIcon: badge_03,
          badgeText: 'ä¸–ç•Œæ¢ç´¢è€…',
          stars: 5,
          hashtag: '#è³‡æ·±æ—…éŠè€…å¤§åŠ›æ¨',
          content:
            'èº«ç‚ºè³‡æ·±èƒŒåŒ…å®¢ï¼ŒçœŸçš„éå¸¸æ¨è–¦é€™å€‹å¹³å°ï¼å®‰æ’è³¼è²·è¡Œç¨‹ä¸€æ¬¡åˆ°ä½ï¼Œè®“å‡ºå»ç©æ›´èƒ½è¼•é¬†è‡ªåœ¨',
        },
        {
          name: 'ç‹å°æ˜',
          avatar: avatar_img01,
          badgeIcon: badge_03,
          badgeText: 'ä¸–ç•Œæ¢ç´¢è€…',
          stars: 5,
          hashtag: '#æ—…éŠç¥å™¨è®šè®šï¼',
          content:
            'æ—…éŠç¥å™¨å¤ªå¥½ç”¨äº†ï¼éå¸¸é©åˆæ—…éŠä¸­æ¯’è€…ä½¿ç”¨ï¼Œåˆ°äº†ä¸€å€‹åœ‹å®¶ï¼Œèƒ½å¤ é¦¬ä¸Šé¡¯ç¤ºå¤©æ°£é å ±ï¼Œéå¸¸æ–¹ä¾¿ï¼',
        },
        {
          name: 'åŠ‰å°èŠ¬',
          avatar: avatar_img02,
          badgeIcon: badge_04,
          badgeText: 'åˆå¿ƒæ—…äºº',
          stars: 4,
          hashtag: '#çœŸäººå®¢æœè§£æ±ºäº†æˆ‘çš„å•é¡Œï¼',
          content:
            'TripEasyäº”æ˜Ÿç´šæœå‹™ï¼Œ24å°æ™‚çš†æœ‰çœŸäººå®¢æœï¼Œä¸æœƒæ“ä½œï¼Œé¦¬ä¸Šå°±æœ‰äººå¯è©¢å•è§£æ±ºï¼è¦å®‰æ’è¡Œç¨‹è‚¯å®šè¦ä¾†ï½',
        },
        {
          name: 'é™³å°èŠ±',
          avatar: avatar_img03,
          badgeIcon: badge_02,
          badgeText: 'ç†±è¡€æ—…éŠå®¶',
          stars: 3,
          hashtag: '#è¡Œç¨‹æ¨è–¦',
          content:
            'é¦–é çš„æœ‹å‹å°ˆå€è¶…é©åˆæ—…éŠè¦åŠƒæ–°æ‰‹ï¼Œæ¨è–¦çš„è¡Œç¨‹çœŸçš„éå¸¸é©åˆæœ‹å‹æ—…éŠï¼Œåƒ¹æ ¼ä¹Ÿå¾ˆåˆç†ï¼',
        },
        {
          name: 'æ¸¸å°å½¥',
          avatar: avatar_img04,
          badgeIcon: badge_05,
          badgeText: 'ä¸–ç•Œæ¢ç´¢è€…',
          stars: 5,
          hashtag: '#è³‡æ·±æ—…éŠè€…å¤§åŠ›æ¨',
          content:
            'èº«ç‚ºè³‡æ·±èƒŒåŒ…å®¢ï¼ŒçœŸçš„éå¸¸æ¨è–¦é€™å€‹å¹³å°ï¼å®‰æ’è³¼è²·è¡Œç¨‹ä¸€æ¬¡åˆ°ä½ï¼Œè®“å‡ºå»ç©æ›´èƒ½è¼•é¬†è‡ªåœ¨',
        },
      ],
      reviewIndex: 0,
      visibleCount: 4,
      starBold,
      starLine,
    };
  },
  computed: {
    visibleReviews() {
      return this.reviews.slice(this.reviewIndex, this.reviewIndex + this.visibleCount);
    },
  },

  methods: {
    scrollToNext() {
      const section = document.querySelector('.home_content');
      if (section) {
        const offset = -120; // ğŸ‘ˆ æƒ³å¾€ä¸Šç•™ç©ºå¤šå°‘ pxï¼Œå¯è‡ªè¡Œèª¿æ•´
        const top = section.getBoundingClientRect().top + window.scrollY + offset;

        window.scrollTo({
          top,
          behavior: 'smooth',
        });
      }
    },

    handleScroll() {
      const section1El = this.$refs.header_page;
      if (section1El) {
        const bottom = section1El.getBoundingClientRect().bottom;
        this.isSticky = bottom <= 0;
        // console.log('[Scroll] isSticky =', this.isSticky);
      }
    },

    // æ”¹é€™æ¨£ï¼šè¼ªæ’­å…©çµ„åç¨±
    startAutoSlide() {
      this.interval = setInterval(() => {
        this.selectedGroup = this.selectedGroup === 'Taiwan' ? 'World' : 'Taiwan';

        if (this.selectedGroup === 'Taiwan') {
          this.currentImages = [...this.imagesTaiwan];
        } else {
          this.currentImages = [...this.imagesWorld];
        }

        this.currentIndex = 0;
      }, 3500);
    },

    stopAutoSlide() {
      clearInterval(this.interval);
    },

    selectGroup(group) {
      this.stopAutoSlide(); // åœæ­¢è‡ªå‹•è¼ªæ’­
      this.autoMode = false; // æ¨™è¨˜ç‚ºæ‰‹å‹•æ¨¡å¼
      this.selectedGroup = group;

      if (group === 'Taiwan') {
        this.currentImages = [...this.imagesTaiwan];
      } else {
        this.currentImages = [...this.imagesWorld];
      }

      this.currentIndex = 0;

      // â± 3 ç§’å¾Œé‡æ–°é–‹å§‹è‡ªå‹•è¼ªæ’­ï¼ˆå¦‚æœä½¿ç”¨è€…æ²’å†é»ï¼‰
      setTimeout(() => {
        this.autoMode = true;
        this.startAutoSlide();
      }, 3000);
    },

    startAutoPlay() {
      this.autoPlayTimer = setInterval(() => {
        this.toolIndex = (this.toolIndex + 1) % this.tools.length;
      }, 4000);
    },

    stopAutoPlay() {
      clearInterval(this.autoPlayTimer);
    },

    handleClick(index) {
      this.toolIndex = index;
      this.stopAutoPlay();

      // è‹¥ä¹‹å‰æœ‰ delay é‚„æ²’åŸ·è¡Œï¼Œå…ˆæ¸…æ‰
      clearTimeout(this.resumeTimer);
      this.resumeTimer = setTimeout(() => {
        this.startAutoPlay();
      }, 5000); // åœ 5 ç§’å¾Œæ¢å¾©è¼ªæ’­
    },

    nextSlide() {
      if (this.reviewIndex + this.visibleCount < this.reviews.length) {
        this.reviewIndex++;
        this.$nextTick(() => {
          this.triggerReviewAnimation();
        });
      }
    },
    prevSlide() {
      if (this.reviewIndex > 0) {
        this.reviewIndex--;
        this.$nextTick(() => {
          this.triggerReviewAnimation();
        });
      }
    },
    triggerReviewAnimation() {
      const cards = document.querySelectorAll('.review_card');
      cards.forEach((card) => {
        card.classList.remove('show');
        // å¼·åˆ¶é‡ç¹ªï¼ˆreflowï¼‰è®“å‹•ç•«å¯ä»¥é‡æ–°è§¸ç™¼
        void card.offsetWidth;
        card.classList.add('show');
      });
    },
    truncatedText(text) {
      return text.length > 50 ? text.slice(0, 50) + '...' : text;
    },
  },

  mounted() {
    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            entry.target.classList.add('show');
          }
        });
      },
      { threshold: 0.2 }
    );

    // å°æ‰€æœ‰ review_card å¥—ç”¨è§€å¯Ÿå™¨
    this.$nextTick(() => {
      const cards = document.querySelectorAll('.review_card');
      cards.forEach((card) => observer.observe(card));
    });

    window.addEventListener('scroll', this.handleScroll, { passive: true });

    this.currentImages = [...this.imagesTaiwan];
    this.startAutoSlide(); // é–‹å§‹è‡ªå‹•åœ¨ Taiwan/World é–“åˆ‡æ›

    this.startAutoPlay();
  },

  beforeUnmount() {
    window.removeEventListener('scroll', this.handleScroll);

    this.stopAutoPlay();
    clearTimeout(this.resumeTimer);
  },
};
</script>

<style scoped>
@import '@/assets/css/reset.css';
@import '@/assets/css/common.css';

/* --- common --- */
h2 {
  display: inline-block;
  position: relative;
  font-size: 32px;
  font-weight: bold;
  letter-spacing: 4px;
  line-height: 38.4px;
  z-index: 1;
}

h2::after {
  content: '';
  position: absolute;
  left: 0;
  bottom: 1px; /* åº•ç·šèˆ‡æ–‡å­—è·é›¢ */
  width: 160px; /* åº•ç·šé•·åº¦ï¼Œé€™è£¡ä½ å¯ä»¥è‡ªè¡Œèª¿æ•´ */
  height: 0.4em; /* é«˜åº¦æ±ºå®šåº•è‰²çš„åšåº¦ */
  border-bottom: 9px solid #b1d6ca;
  z-index: -1; /* åº•ç·šåœ¨æ–‡å­—ä¸‹é¢ */
  border-radius: 4px; /* åœ“è§’å¯é¸ */
}

.home_content {
  margin-top: 120px;
  margin-bottom: 80px;
}

/* --- nav --- */
.nav {
  position: fixed;
  top: 0;
  width: 100%;
  padding: 45px;
  text-align: center;
  transform: translateY(-100%);
  transition: transform 0.3s ease;

  z-index: 1000;
}

.nav.show {
  transform: translateY(0);
}

.header_page,
.section {
  padding: 30px 0;
}

/* --- header --- */
.header_page {
  height: 100vh;
  display: flex;
  flex-direction: column;

  justify-content: space-around;
  text-align: center;
}

/* --- header_main --- */
.header_main {
  display: flex;
  flex-direction: row;
  justify-content: center;
}

/* --- header_country --- */
.header_country {
  width: 300px;
  position: relative;

  display: flex;
  justify-content: center;
  align-items: center;
}

.header_country ul {
  width: 200px;
  display: flex;
  flex-direction: column;

  padding: 0 !important;
}

.header_country ul li:nth-child(odd) {
  align-self: flex-end;
}

.header_country ul li:nth-child(even) {
  align-self: flex-start;
}

/* åœ–ç‰‡æ·¡å…¥å‹•ç•« */
@keyframes fadeIn {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}

.fade-in-img {
  animation: fadeIn 1s ease;
}

/* --- åœ–ç‰‡ --- */
.header_country ul img {
  width: 130px;
}

.header_country .illustration img {
  width: 70px;
}

.header_img {
  align-self: center;
}

.header_img img {
  width: 550px;
  margin: 0 100px 0 20px;
}

/* --- å°æ’åœ– --- */
.header_country .illustration span {
  position: absolute;
}

.header_country .illustration span:first-child {
  top: 0;
  left: 20px;
}

.header_country .illustration span:last-child {
  bottom: 0;
  right: 20px;
}

/* --- header_slogan --- */
.header_slogan {
  display: flex;
  flex-direction: column;
  justify-content: space-between;

  gap: 150px;
  font-size: 36px;
  font-weight: bold;

  padding: 30px 40px;

  background-color: #ffffff;
}

/* --- æ–‡å­— --- */
.header_slogan .slogan_content {
  writing-mode: vertical-rl;
  text-orientation: upright;

  letter-spacing: 12px;
  line-height: 62.4px;
}

.header_slogan .slogan_content p:last-child {
  text-indent: 96px;
}

/* --- icon --- */
.header_slogan .slogan_icon {
  display: flex;
  justify-content: center;
  gap: 15px;

  cursor: pointer;
}

.header_slogan .slogan_icon img {
  border-radius: 100px;
  border: 2px solid #000;
  background-color: #f2f2f2;

  padding: 12px;
}

.header_slogan .slogan_icon img:hover,
.header_slogan .slogan_icon img.active {
  filter: invert(1);
}

/* --- start_btn --- */
.start_btn {
  display: flex;
  flex-direction: column;

  gap: 12px;
  cursor: pointer;
  font-size: 20px;
}

.start_btn img {
  animation: floatArrow 1.5s ease-in-out infinite;
}

/* å®šç¾©å‹•ç•« */
@keyframes floatArrow {
  0% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(-8px); /* å¾€ä¸Š */
  }
  100% {
    transform: translateY(0);
  }
}

/* --- item_category --- */
.item_category {
  margin-bottom: 180px;
}

.item_category ul {
  display: flex;
  justify-content: space-between;
  gap: 24px;

  margin: 60px 0 30px 0;
}

.item_category ul li {
  width: 33%;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 28px;
  text-align: center;

  color: #333333;
  background: #f2f2f2;
  border: 2px solid #d4d4d4;
  border-radius: 28px;

  padding: 34px 64px;
}

.item_category ul li h3 {
  font-size: 24px;
  font-weight: 700;
}

.item_category ul li img {
  width: 180px;
}

.item_category ul li p {
  font-size: 14px;
  font-weight: 400;
  line-height: 30px;
}

/* --- product --- */
.product {
  margin-bottom: 180px;
}

.product_content {
  display: flex;

  justify-content: space-between;
}

.product_content .content_left {
  width: 50%;
}

.product_content .content_right {
  width: 40%;
}

/* --- product item_title --- */
.product_content .item_title {
  display: flex;
  justify-content: space-between;

  margin-bottom: 20px;
}

.product_content .content_left .type_group {
  writing-mode: vertical-lr;
}

.product_content .content_left .type_group li a {
  display: inline-block;
  font-size: 14px;
  font-weight: 700;

  border: 2px solid transparent;
  border-radius: 100px;
  color: #5b5b5b;

  padding: 14px 7px;
  letter-spacing: 5px;

  transition: background-color 0.5s ease;
}

.product_content .content_left .type_group li:first-child {
  margin-right: 20px;
}

.product_content .content_left .type_group a:hover {
  background-color: #d4d4d4;
  color: #5b5b5b;
}

.product_content .content_left .type_group a:focus {
  color: #5b5b5b;
  background-color: transparent;
  border: 2px solid #d4d4d4;
}

.product_content .content_left .type_group .active {
  background-color: #5b5b5b;
  color: #ffffff;
}

/* --- product item_group --- */
.product_content .content_left .item_group {
  display: flex;
  gap: 24px;

  align-items: center;
}

.product_content .content_left .item_group a {
  display: inline-block;
  font-size: 14px;
  font-weight: 700;

  border-radius: 100px;
  border: 2px solid #5b5b5b;
  color: #5b5b5b;

  padding: 7px 14px 5px 14px;
  letter-spacing: 2px;

  transition: background-color 0.5s ease;
}

.product_content .content_left .item_group a:hover,
.product_content .content_left .item_group .active {
  background-color: #333333;
  border: 2px solid #333333;
  color: #ffffff;
}

/* product product_item */
.content_left .product_item {
  margin-top: 17px;
  margin-bottom: 45px;
}

.content_left .product_item .i_list {
  border-bottom: 1px solid #d4d4d4;
  padding: 10px 0;
}

.content_left .product_item .i_list .i_container {
  display: flex;
  justify-content: space-between;
  align-items: center;

  padding: 15px 12px;
  border-radius: 10px;

  transition: 0.5s background-color ease;
}

.content_left .product_item .i_container:hover {
  background-color: rgba(255, 255, 255, 0.4);
  border-radius: 10px;
}

.content_left .product_item .product_left ul {
  display: flex;
  gap: 4px;

  align-items: center;

  margin-bottom: 14px;
}

.content_left .product_item .product_left ul li {
  font-size: 12px;
  background-color: #ffdd78;
  border-radius: 40px;
  font-weight: 700;

  padding: 4px 12px;
}

.content_left .product_item .product_left h3 {
  font-size: 24px;
  line-height: 28.8px;
  letter-spacing: 4px;

  font-weight: 700;
}

.content_left .product_item .product_right {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 20px;

  color: #212121;
  line-height: 30px;
}

.content_left .product_item .product_right p:first-child {
  font-weight: 400;
  letter-spacing: 3px;

  margin-bottom: 4px;
}

.content_left .product_item .product_right p:last-child span:first-child {
  font-weight: 700;
  letter-spacing: 3px;
}

.content_left .product_item .product_right p:last-child span:last-child {
  font-weight: 700;
  letter-spacing: 3px;
  font-size: 20px;
}

.content_left .product_item .product_right .favorite {
  margin-top: 10px;
  opacity: 0;
  transition: opacity 0.5s ease;

  cursor: pointer;
}

.content_left .product_item .i_container:hover .favorite {
  opacity: 1;
}

/* product product_page */
.product_content .content_left .product_page {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 20px;

  font-weight: bold;
}

.product_content .content_left .product_page img {
  border-radius: 20px;
  background: #d4d4d4;

  padding: 4px;
  vertical-align: middle;

  cursor: pointer;

  transition: 0.5s background-color ease;
}

.product_content .content_left .product_page img:hover {
  background-color: #d4d4d484;
}

.product_content .content_right {
  display: flex;
  align-items: center;
}

/* product main_item */
.product_content .content_right .main_item img {
  width: 500px;
}

.product_content .content_right .main_item {
  position: relative;
}

/* product illustration */
.product_content .content_right .illustration img {
  width: 120px;

  position: absolute;
}

.product_content .content_right .illustration .l_first {
  z-index: -10;
  width: 160px;
  top: 35px;
  right: -80px;
}

.product_content .content_right .illustration .l_last {
  bottom: 10px;
  left: 0;
}

/* product more */
.product .more {
  display: flex;
  justify-content: flex-end;
  align-items: center;
  gap: 12px;

  font-size: 20px;
  font-weight: 400;

  cursor: pointer;

  margin-top: 10px;
}

.product .more span {
  display: inline-block;
}

.product .more span img {
  margin-top: 4px;
  animation: floatArrow_more 1.5s ease-in-out infinite;
}

/* å®šç¾©å‹•ç•« */
@keyframes floatArrow_more {
  0% {
    transform: translateX(0);
  }
  50% {
    transform: translateX(-8px);
  }
  100% {
    transform: translateX(0);
  }
}

/* --- travel_tool --- */
.travel_tool {
  margin-bottom: 180px;
}

.travel_title {
  margin-bottom: 150px;
}

.travel_content {
  display: flex;
  justify-content: space-between;
  gap: 30px;

  position: relative;
}

.travel_content .main_item img {
  width: 500px;
  border-radius: 600px;
  border: 4px solid #ffffff;
}

.travel_content .travel_function li a {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 120px;
  height: 120px;
  text-align: center;
  line-height: 25px;

  color: #5b5b5b;
  border: 2px solid #333333;
  border-radius: 100px;

  padding: 12px 20px;
  font-weight: 700;

  transition:
    0.6s background-color ease,
    0.6s color ease;
}

.travel_content .travel_function li a.active,
.travel_content .travel_function li a:hover {
  color: #ffffff;
  background: #333333;
}

.travel_content .travel_function .func {
  position: absolute;
  z-index: 10; /* æé«˜å±¤ç´š */
}

.travel_content .travel_function .func1 {
  top: -80px;
  left: 410px;
}
.travel_content .travel_function .func2 {
  top: 40px;
  left: 500px;
}
.travel_content .travel_function .func3 {
  top: 185px;
  left: 530px;
}
.travel_content .travel_function .func4 {
  top: 330px;
  left: 500px;
}
.travel_content .travel_function .func5 {
  top: 450px;
  left: 410px;
}

.travel_content .travel_dot li {
  width: 15px;
  height: 15px;
  text-align: center;

  background: #d4d4d4;
  border-radius: 100px;
}

.travel_content .travel_dot li.active {
  background: #333333;
}

.travel_content .travel_dot .dot {
  position: absolute;
  z-index: 10;
}

.travel_content .travel_dot .dot1 {
  top: -100px;
  left: 530px;
}
.travel_content .travel_dot .dot2 {
  top: 40px;
  left: 633px;
}
.travel_content .travel_dot .dot3 {
  top: 235px;
  left: 685px;
}
.travel_content .travel_dot .dot4 {
  top: 420px;
  left: 643px;
}
.travel_content .travel_dot .dot5 {
  top: 560px;
  left: 545px;
}

svg.arc-path {
  position: absolute;
  top: -100px;
  left: 300px;
  z-index: 0;
}

.travel_right {
  display: flex;
  justify-content: center;
  align-items: center;
}

.main_content .travel_new {
  display: flex;
  justify-content: center;
  align-items: center;

  width: 450px;
  height: 450px;
  font-size: 28px;
  font-weight: 700;
  background: #ffffff;
  border-radius: 420px;

  text-align: center;
  letter-spacing: 6px;
  line-height: 38px;

  padding: 32px 48px;
}

/* travel_tool illustration */
.main_content .illustration img {
  width: 180px;

  position: absolute;
}

.main_content .illustration .l_first {
  width: 90px;
  top: 0px;
  left: 730px;
}

.main_content .illustration .l_last {
  bottom: 0px;
  right: 0;
}

/* travel_tool more */
.travel_tool .more {
  display: flex;
  justify-content: flex-end;
  align-items: center;
  gap: 12px;

  font-size: 20px;
  font-weight: 400;

  cursor: pointer;

  margin-top: 100px;
}

.travel_tool .more span {
  display: inline-block;
}

.travel_tool .more span img {
  margin-top: 4px;
  animation: floatArrow_more 1.5s ease-in-out infinite;
}

/* å®šç¾©å‹•ç•« */
@keyframes floatArrow_more {
  0% {
    transform: translateX(0);
  }
  50% {
    transform: translateX(-8px);
  }
  100% {
    transform: translateX(0);
  }
}

/* --- review --- */
.reviews .main_contents {
  display: flex;

  margin-top: 90px;
  position: relative;
}

.reviews .main_contents .review_contents {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 24px;
}

.reviews .main_contents .review_contents li {
  background-color: #ffffff;

  border-radius: 12px;
  padding: 52px 32px 40px 32px;
  position: relative;

  width: 25%;
}

.reviews .main_contents .review_contents li .avatar {
  position: absolute;
  top: -35px;
  left: 30px;

  border-radius: 100px;
}

.reviews .main_contents .review_contents li .reviews_info {
  padding-bottom: 12px;
  margin-bottom: 12px;
  border-bottom: 1px solid #d4d4d4; /* æˆ–ä½ è¦çš„é¡è‰² */
}

.reviews .main_contents .review_contents li .i_title {
  display: flex;
  align-items: center;
  gap: 12px;

  font-weight: 700;
  margin-bottom: 8px;
}

.reviews .main_contents .review_contents li .i_title .name {
  font-size: 20px;
}

.reviews .main_contents .review_contents li .i_title .badge {
  display: flex;
  align-items: center;
  gap: 4px;
}

.reviews .main_contents .review_contents li .i_title .badge span {
  color: #5b5b5b;
}

.reviews .main_contents .review_contents li .rating img {
  width: 16px;
}

.reviews .main_contents .review_contents li .reviews_content .hashtag {
  font-size: 20px;
  font-weight: 700;
  color: #212121;

  margin-bottom: 12px;

  display: -webkit-box;
  -webkit-line-clamp: 1; /* æœ€å¤šé¡¯ç¤º 3 è¡Œ */
  -webkit-box-orient: vertical;
  overflow: hidden;
  text-overflow: ellipsis;
}

.reviews .main_contents .review_contents li .reviews_content .content {
  line-height: 24px;
  letter-spacing: 3px;

  display: -webkit-box;
  -webkit-line-clamp: 3; /* æœ€å¤šé¡¯ç¤º 3 è¡Œ */
  -webkit-box-orient: vertical;
  overflow: hidden;
  text-overflow: ellipsis;
}

.reviews .main_contents .left_btn,
.reviews .main_contents .right_btn {
  display: flex;
  justify-content: center;
  align-items: center;

  position: absolute;

  border: 2px solid #5b5b5b;
  border-radius: 100px;
  padding: 16px;

  background-color: #f2f2f2;
  cursor: pointer;

  transition: 0.4s filter ease;
}

.reviews .main_contents .left_btn {
  top: 120px;
  left: -84px;
}

.reviews .main_contents .right_btn {
  top: 120px;
  right: -84px;
}

.reviews .main_contents .left_btn:hover,
.reviews .main_contents .right_btn:hover {
  filter: invert(1);
  border: 2px solid #333333;
}

.review_card {
  opacity: 0;
  transition: opacity 0.8s ease;
}

.review_card.show {
  opacity: 1;
}
</style>
